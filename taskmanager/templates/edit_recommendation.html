{% extends "base.html" %}
{% block content %}


<!-- banner -->
<div class="bg-dgreen">
    <div class="container heading-banner valign-wrapper">
        <div class="row val">
            <div class="col s12 center-align">
                <h1 class="fira-600 white-text">EDIT</h1>
            </div>
        </div>
    </div>
</div>

<div class="bg-lblue" id="a-recommendation-page">
    <div class="container col s10 bg-white blue-container">
        <div class="row">
            <form class="col s12" method="POST"
                action="{{ url_for('edit_recommendation', recommendation_id=recommendation.id) }}"
                enctype="multipart/form-data">
                <!-- Recommendation name field -->
                <div class="row">
                    <div class="input-field col s9">
                        <input id="recommendation_name" placeholder="Max 30 characters" name="recommendation_name"
                            value="{{ recommendation.recommendation_name }}" minlength="3" maxlength="30" type="text"
                            class="validate" required oninput="checkMaxLength(this)">
                        <label for="recommendation_name">Holiday Title</label>
                    </div>
                </div>
                <!-- Holiday Type Id (User select from name) -->
                <div class="row">
                    <div class="input-field col s9">
                        <select id="holiday_id" name="holiday_id" class="validate" required>
                            <option value="" disabled>Choose Holiday Type</option>
                            {% for holiday_type in holiday_types %}
                                {% if holiday_type == recommendation.holiday_type %}
                                <option value="{{ holiday_type.id }}" selected>{{ holiday_type.holiday_name }}</option>
                                {% else %}
                                <option value="{{ holiday_type.id }}">{{ holiday_type.holiday_name }}</option>
                                {% endif %}
                            {% endfor %}
                        </select>
                        <label for="holiday_id">Holiday Type</label>
                    </div>
                </div>
                <!-- Region (User select from options) -->
                <div class="row">
                    <div class="input-field col s9">
                        <select id="region" name="region" class="validate" placeholder="Select Region" required>
                            <option value="" disabled>Choose Region</option>
                            {% if region == recommendation.region %}
                            <option value="{{ recommendation.occupants }}" selected>{{ recommendation.region }}</option>
                            {% else %}                 
                            <option value="South-West">South West</option>
                            <option value="South-East">South East</option>
                            <option value="West-Midlands">West Midlands</option>
                            <option value="East-Midlands">East Midlands</option>
                            <option value="North-West">North West</option>
                            <option value="North-East">North East</option>
                            <option value="Yorkshire-and-the-Humber">Yorkshire and the Humber</option>
                            <option value="East-of-England">East of England</option>
                            <option value="London">London</option>
                            {% endif %}
                        </select>
                        <label for="region">Region</label>
                    </div>
                </div>

                <div class="row">
                    <!-- Occupant Selection -->
                    <div class="input-field col s3">
                        <select id="occupants" name="occupants" class="validate" required>
                            <option value="" disabled>Select Occupants</option>
                            {% if occupants == recommendation.occupants %}
                            <option value="{{ recommendation.occupants }}" selected>{{ recommendation.occupants }}</option>
                            {% else %}                                                        
                            <option value="2">2</option>
                            <option value="3-4">3-4</option>
                            <option value="5-6">5-6</option>
                            <option value="7-8">7-8</option>
                            <option value="9+">9+</option>
                            {% endif %}
                        </select>
                        <label for="occupants">Occupants</label>
                    </div>                     
                
                    <!-- Date Selection -->
                    <div class="input-field col s6">
                        <label for="recommendation_date"></label>
                        <input id="recommendation_date" name="recommendation_date" class="validate datepicker" required
                            value="{{ recommendation.recommendation_date.strftime('%d %B, %Y') }}">
                    </div>
                </div>

                <!-- Location Name and map (map code adapted from Imran Sayed at Codeytek Academy youtube tutorial)-->
                <div class="row">
                    <div class="input-field col s12">
                        <input id="location_name" name="location_name" class="validate" type="text"
                            value="{{ recommendation.location_name }}" maxlength="
                        120" required>
                        <label for="location_name">Address</label>
                    </div>
                </div>

                <div>Please check the location on the map and either move the marker or re-type your location.</div>

                <div id="map-canvas"></div>

                <!-- HIDDEN FROM USER, autofilled by JS using location/map" -->
                <!-- map Longitude -->
                <div class="row" style="display: none;">
                    <div class="input-field col s6">
                        <label for="map_long"></label>
                        <input id="map_long" name="map_long" type="text" value="{{ recommendation.map_long }}" required>
                    </div>
                </div>
                <!-- map Latitude -->
                <div class="row" style="display: none;">
                    <div class="input-field col s6">
                        <label for="map_lat"></label>
                        <input id="map_lat" name="map_lat" type="text" value="{{ recommendation.map_lat }}" required>
                    </div>
                </div>

                <!-- Recommendation Review-->
                <div class="row">
                    <div class="input-field col s12">
                        <textarea id="recommendation_review" name="recommendation_review"
                            class="materialize-textarea validate" maxlength="2000"                            
                            required>{{ recommendation.recommendation_review }}</textarea>
                        <label for="recommendation_review">Review</label>
                    </div>
                </div>

                <div class="row">
                    <div class="input-field col s12">
                        <p>Your chosen image is displayed below. Ensure any new images selected are in landscape
                            orientation for optimal display. Please note, if you do not wish to change the image, leave
                            the file upload reading "No file chosen".</p>
                    </div>
                </div>

                <!-- Image Upload-->
                <div class="row">
                    <div class="input-field col s12">
                        <input type="file" id="image" name="image">
                        <button type="button" id="upload-button">Save</button>
                        <label for="image"></label>
                    </div>

                    <div class="col s12" id="uploaded-image"><img
                            src="{{ url_for('static', filename='images/user_uploaded_images/' + recommendation.image_name) }}">
                    </div>
                    <!-- HIDDEN FROM USER-->
                    <!-- Mime Type -->
                    <div class="row" style="display: none;">
                        <div class="col s6">
                            <input id="mimetype" name="mimetype" type="text" value="{{ recommendation.mimetype }}"
                                required>
                            <label for="mimetype">mimetype</label>
                        </div>
                    </div>
                </div>
                <!-- HIDDEN FROM USER-->
                <!-- User ID -->
                <div class="row" style="display: none;">
                    <div class="input-field col s6">
                        <label for="user_id">User ID</label>
                        <input id="user_id" name="user_id" type="text" required value="{{ session.get('user_id') }}"
                            required>
                    </div>
                </div>

                <!-- Send button -->
                <div class="col s12 center-align">
                    <button type="submit" id="submit-button"
                        class="col s8 offset-s2 m6 offset-m3 l3 offset-l4 btn-large btn-dgreen">Save
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
</div>

{% endblock %}

{% block scripts %}
<!-- image upload specific JS-->
<script src="{{ url_for('static', filename='js/addRecommendation.js') }}"></script>
<!-- Maps specific JS-->
<script src="{{ url_for('static', filename='js/maps.js') }}"></script>
<!-- Google Maps API -->
<script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDY8GR3DNBlbz_RmwXJF7SRbBn4igCcsUg&libraries=places&callback=initialize">
</script>
{% endblock %}